// export all docs of book as idml to choosen folder// wirtten by fabianthelbind// http://www.the-moron.net// based on //doScriptWithDocsOfBooks.js // found on http://indesign.hilfdirselbst.ch/oberflache/skript-in-allen-dokumenten-der-geoffneten-buchern-ausfuhren.html// export selection as jpg// found on: http://indisnip.wordpress.com/2010/08/09/export-selection-to-jpeg/// Now it works!!// needs 2 folders on the desktop "source" and "target"main();function main(){var sourceFolder = Folder.selectDialog ("Choose a source FOLDER ");var targetFolder =Folder.selectDialog ("Choose a target FOLDER");try{var aBook = app.books.add(sourceFolder + "/testBook.indb");} catch(e){        $.writeln(e);        exit();        }var docs = new Array();for (var i = 0; i < 5;i ++){    docs[i] = app.documents.add();    //docs[i].name = "testDoc_" + i;    docs[i].save(sourceFolder + "/"+docs[i].name + ".indd");    aBook.bookContents.add(docs[i].fullName);    docs[i].close(SaveOptions.YES);    //aBook.forceSave(true);    }if ( app.books.length < 1 ){    errorExit( "you need at least one book" );    }//var theFolder = Folder.selectDialog ("Choose a FOLDER to exportTo");var theFolder= "~/Desktop/target";       //alert(theFolder);              for ( var b = 0; b < app.books.length; b++ )              doBook( app.books[b],theFolder); }function doBook( aBook,theFolder ){      for ( var i = 0; i < aBook.bookContents.length; i++ ){    var content = aBook.bookContents[i];    var doc = app.open(content.fullName);        var aName = doc.name;    var newName = aName.replace("indd","idml");    var theFile = File(targetFolder +"/"+ newName );    doc.exportFile(ExportFormat.INDESIGN_MARKUP, theFile, false);    doc.close(SaveOptions.NO);        }}  