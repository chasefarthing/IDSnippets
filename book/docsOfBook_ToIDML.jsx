// export all docs of book as idml to choosen folder// wirtten by fabianthelbind// http://www.the-moron.net// needs 2 folders on the desktop "source" and "target"main();function main(){// folder actions based on: http://tinyurl.com/2c3kv8r // HDS// choose a foldervar workspaceFolder = Folder.selectDialog ("Choose a FOLDER to work in");// and make to folders     var sourceFolder = new Folder(workspaceFolder.fsName +"/source");     if(!sourceFolder.exists){ 	sourceFolder.create();     }       var targetFolder = new Folder(workspaceFolder.fsName +"/target");     if(!targetFolder.exists){ 	targetFolder.create();     }// get the paths rightvar sF = sourceFolder.fsName;var tF = targetFolder.fsName;//build the bookvar aBook = app.books.add(sF + "/testBook.indb");var bName = aBook.name;// make some docsvar docs = new Array();for (var i = 0; i < 5;i ++){    docs[i] = app.documents.add();    docs[i].save(sF + "/"+docs[i].name + ".indd");    aBook.bookContents.add(docs[i].fullName);    docs[i].close(SaveOptions.YES);    }// save the book. You dont need that    aBook.save(sF + "/testBook.indb");// this is a check if there is a book// in our case useless but usefull if this part gets extractedif ( app.books.length < 1 ){    errorExit( "you need at least one book" );    }// now go thru the books content and make idmls       for ( var b = 0; b < app.books.length; b++ )              doBook( app.books[b],tF); }// taken from // doScriptWithDocsOfBooks.js // found on http://tinyurl.com/29bm8xj // HDSfunction doBook( aBook,theFolder ){      for ( var i = 0; i < aBook.bookContents.length; i++ ){// thnx to Neil77 from HDS    var content = aBook.bookContents[i];    var doc = app.open(content.fullName);// take the .indd's name and make a .idml from it    var aName = doc.name;    var newName = aName.replace("indd","idml");    var theFile = File(theFolder +"/"+ newName );// export    doc.exportFile(ExportFormat.INDESIGN_MARKUP, theFile, false);// dont need to save right now    doc.close(SaveOptions.NO);        }}  